<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Score samples using the CSCI tool — CSCI • CSCI</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Score samples using the CSCI tool — CSCI" />

<meta property="og:description" content="A function that aggregates many of the steps involved in the scoring of the California Stream Condition Index
(CSCI) into a single function. These steps include data quality flagging, conversions of taxonomic names,
iterative subsampling (20 iterations), metric calculations, prediction of expected taxa and metric values,
scoring, and aggregation into a final index. Input data includes sample-wise raw, unprocessed taxonomy 
in a flat format, and station-wise predictor data in a crosstab format. See example data (bugs_stations)
for reference. A complete description of the index is provided in Mazor et al. (in review). The O/E component 
of this function is adapted from John van Sickle's RIVPACS model building scripts." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CSCI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Score samples using the CSCI tool</h1>
    
    <div class="hidden name"><code>CSCI.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>A function that aggregates many of the steps involved in the scoring of the California Stream Condition Index
(CSCI) into a single function. These steps include data quality flagging, conversions of taxonomic names,
iterative subsampling (20 iterations), metric calculations, prediction of expected taxa and metric values,
scoring, and aggregation into a final index. Input data includes sample-wise raw, unprocessed taxonomy 
in a flat format, and station-wise predictor data in a crosstab format. See example data (<code><a href='bugs_stations.html'>bugs_stations</a></code>)
for reference. A complete description of the index is provided in Mazor et al. (in review). The O/E component 
of this function is adapted from John van Sickle's RIVPACS model building scripts.</p>
    
    </div>

    <pre class="usage"><span class='fu'>CSCI</span>(<span class='no'>bugs</span>, <span class='no'>stations</span>, <span class='kw'>rand</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample.int</a></span>(<span class='fl'>10000</span>, <span class='fl'>1</span>), <span class='kw'>distinct</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>bugs</th>
      <td><p>A data frame with BMI data (see details)</p></td>
    </tr>
    <tr>
      <th>stations</th>
      <td><p>A data frame with environmental data, one row per station (see details)</p></td>
    </tr>
    <tr>
      <th>rand</th>
      <td><p>An integer to control the random number generator (RNG) seed for the subsampling. By default set to
<code><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample.int(10000, 1)</a></code></p></td>
    </tr>
    <tr>
      <th>distinct</th>
      <td><p>A logical value to overwrite the <code>Distinct</code> column in <code>bugs</code> with <code>NA</code> values, default (<code>FALSE</code>) is leave as is.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of data frames that serve as reports in varying detail:</p>
<dt>core</dt><dd><p>A summary of the CSCI results, and data quality flags, averaged across 20 iterations.</p></dd>
<dt>Suppl1_mmi</dt><dd><p>A detailed breakdown of the results of the MMI component of the
 CSCI, averaged across 20 iterations.</p></dd>
<dt>Suppl1_grps</dt><dd><p>Probability of biotic group membership in a SampleID by Group format</p></dd>
<dt>Suppl1_OE</dt><dd><p>A detailed breakdown of the results of the O/E component of the CSCI,
 averaged across 20 iterations. Capture probabilities and mean abundances of each OTU are provided.</p></dd>
<dt>Suppl2_mmi</dt><dd><p>Similar to Suppl1_mmi, except broken down by iteration</p></dd>
<dt>Suppl2_OE</dt><dd><p>Similar to Suppl1_OE, except brown down by replicatesiteration. Iteration-wise O/E scores are also provided.</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A valid "bugs" data frame consists of the following columns: StationCode, SampleID, FinalID (i.e., taxa names),
LifeStageCode ("A", "L", "P", or "X"), BAResult (i.e., taxa counts), and Distinct (a positive integer where 
the taxonomist has indicated distinctiveness, else left blank or 0). Values for FinalID and LifeStageCode 
must conform to values from SWAMP lookup tables (<a href='http://swamp.mpsl.mlml.calstate.edu/'>http://swamp.mpsl.mlml.calstate.edu/</a>). See CSCI guidance 
document for details on these fields.</p>
<p>A valid "stations" data frame consists of the following columns: StationCode (must match with same column in 
the "bugs" data frame), BDH_AVE, ELEV_RANGE, KFCT_AVE, P_MEAN, LogWSA, New_Lat, New_Long, PPT_00_09,
SITE_ELEV, SumAve_P, TEMP_00_09. See CSCI guidance document for details on these fields.</p>
<p>The data frames are also subject to the following constraints: no missing blank cells in any field in 
either data frame (except for the Distinct column); all values under StationCode in the "bugs" data frame 
must be represented under StationCode in the "stations" data frame; every SampleID must be associated 
with only a single StationCode; no duplicated data in either data frame (e.g., every combination of 
the SampleID, FinalID, LifeStageCode, and Distinct should be unique in the "bugs" data frame).</p>
<p>In order to produce replicable results, the RNG seed can be controlled using the rand argument. Any integer may be
entered, which will be passed to <code><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>R.D. Mazor, A. Rehn, P. R. Ode, M. Engeln, K. Schiff. (2013) <em>Development
of a bioassessment tool for streams in heterogeneous regions: Accommodating environmental complexity
through site specificity in the California Stream Condition Index</em>. In review.</p>
<p>J. Van Sickle. (2010) <em>R code to make predictions of O/E 
for a new set of sites based on a Random Forest predictive model</em> (Version 4.2)[R script]</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='bugs_stations.html'>bugs_stations</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>bugs_stations</span>) <span class='co'>#A list of two data frames: bugs and stations</span>
<span class='no'>results</span> <span class='kw'>&lt;-</span> <span class='fu'>CSCI</span>(<span class='kw'>bugs</span> <span class='kw'>=</span> <span class='no'>bugs_stations</span><span class='kw'>[[</span><span class='fl'>1</span>]], <span class='kw'>stations</span> <span class='kw'>=</span> <span class='no'>bugs_stations</span><span class='kw'>[[</span><span class='fl'>2</span>]])
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/ls'>ls</a></span>(<span class='no'>results</span>) <span class='co'>#see all the components of the report</span></div><div class='output co'>#&gt; [1] "core"        "Suppl1_grps" "Suppl1_mmi"  "Suppl1_OE"   "Suppl2_mmi" 
#&gt; [6] "Suppl2_OE"  </div><div class='input'><span class='no'>results</span>$<span class='no'>core</span> <span class='co'>#see the core report</span></div><div class='output co'>#&gt;   StationCode   SampleID Count Number_of_MMI_Iterations Number_of_OE_Iterations
#&gt; 1       Site3 BadSample1   100                        1                       1
#&gt; 2       Site3 BadSample2   600                       20                       1
#&gt; 3       Site1    Sample1   556                       20                      20
#&gt; 4       Site2    Sample2   826                       20                      20
#&gt; 5       Site3    Sample3   607                       20                      20
#&gt; 6       Site3    Sample4   513                       20                       1
#&gt;   Pcnt_Ambiguous_Individuals Pcnt_Ambiguous_Taxa         E Mean_O     OoverE
#&gt; 1                  0.0000000            0.000000 10.248486   1.00 0.09757538
#&gt; 2                 83.3333333           50.000000 10.248486   1.00 0.09757538
#&gt; 3                  0.5395683            2.631579  7.544418   8.95 1.18630752
#&gt; 4                  0.9685230            1.666667 12.953853  11.15 0.86074778
#&gt; 5                  9.7199341            6.250000 10.248486  13.15 1.28311631
#&gt; 6                 37.6218324           41.025641 10.248486   9.00 0.87817846
#&gt;   OoverE_Percentile       MMI MMI_Percentile      CSCI CSCI_Percentile
#&gt; 1              0.00 0.1638082           0.00 0.1306918            0.00
#&gt; 2              0.00 0.3488195           0.00 0.2231975            0.00
#&gt; 3              0.84 0.8281616           0.17 1.0072346            0.52
#&gt; 4              0.23 0.8295090           0.17 0.8451284            0.17
#&gt; 5              0.93 1.2047019           0.87 1.2439091            0.94
#&gt; 6              0.26 0.9080194           0.30 0.8930989            0.25</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Mark Engeln <a href='mailto:marke@sccwrp.org'>marke@sccwrp.org</a></p>
<p>Raphael Mazor <a href='mailto:raphaelm@sccwrp.org'>raphaelm@sccwrp.org</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Mark Engeln, Marcus W Beck.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

